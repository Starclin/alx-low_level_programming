moooore functions and nested loops
